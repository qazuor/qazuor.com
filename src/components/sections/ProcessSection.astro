---
/**
 * ProcessSection - Horizontal timeline showing the development process
 * Displays 6 steps: Discovery → Planning → Design → Development → Testing → Launch
 * Responsive: horizontal timeline on desktop, vertical on mobile
 */

import SectionTitle from '@/components/ui/SectionTitle.astro';
import { processSteps } from '@/data/process';

interface ProcessStepTranslation {
    title: string;
    description: string;
}

interface Props {
    translations: {
        title: string;
        subtitle: string;
        steps: Record<string, ProcessStepTranslation>;
    };
}

const { translations } = Astro.props;

// Dynamic imports for process icons
const iconImports: Record<string, string> = {
    'magnifying-glass-circle': (await import('@/icons/ui/magnifying-glass-circle.svg?raw')).default,
    'clipboard-document-list': (await import('@/icons/ui/clipboard-document-list.svg?raw')).default,
    'paint-brush': (await import('@/icons/ui/paint-brush.svg?raw')).default,
    'code-bracket': (await import('@/icons/ui/code-bracket.svg?raw')).default,
    beaker: (await import('@/icons/ui/beaker.svg?raw')).default,
    'rocket-launch': (await import('@/icons/ui/rocket-launch.svg?raw')).default
};

// Color palette for steps (gradient from purple to cyan)
const stepColors = [
    { bg: 'bg-violet-500/20', border: 'border-violet-500/50', text: 'text-violet-400', dot: 'bg-violet-500' },
    { bg: 'bg-purple-500/20', border: 'border-purple-500/50', text: 'text-purple-400', dot: 'bg-purple-500' },
    { bg: 'bg-fuchsia-500/20', border: 'border-fuchsia-500/50', text: 'text-fuchsia-400', dot: 'bg-fuchsia-500' },
    { bg: 'bg-pink-500/20', border: 'border-pink-500/50', text: 'text-pink-400', dot: 'bg-pink-500' },
    { bg: 'bg-rose-500/20', border: 'border-rose-500/50', text: 'text-rose-400', dot: 'bg-rose-500' },
    { bg: 'bg-emerald-500/20', border: 'border-emerald-500/50', text: 'text-emerald-400', dot: 'bg-emerald-500' }
];
---

<div class="process-section py-16">
    <div class="container-custom">
        <!-- Section Title -->
        <SectionTitle title={translations.title} subtitle={translations.subtitle} />

        <!-- Desktop Timeline (horizontal) -->
        <div class="hidden lg:block mt-12">
            <!-- Timeline Line -->
            <div class="relative">
                <!-- Connector line -->
                <div class="absolute top-12 left-0 right-0 h-0.5 bg-gradient-to-r from-violet-500 via-fuchsia-500 to-emerald-500 opacity-30" />

                <!-- Steps -->
                <div class="grid grid-cols-6 gap-4">
                    {processSteps.map((step, index) => {
                        const stepTranslation = translations.steps[step.id];
                        const colors = stepColors[index];
                        const iconSvg = iconImports[step.iconId];

                        return (
                            <div class="relative flex flex-col items-center text-center group">
                                <!-- Step Number + Icon -->
                                <div
                                    class={`relative z-10 w-24 h-24 rounded-2xl ${colors.bg} ${colors.border} border-2 flex flex-col items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:shadow-lg group-hover:shadow-primary/20`}
                                >
                                    <span class={`text-xs font-bold ${colors.text} mb-1`}>
                                        {String(step.number).padStart(2, '0')}
                                    </span>
                                    <div class={`w-8 h-8 ${colors.text}`} set:html={iconSvg} />
                                </div>

                                <!-- Dot on timeline -->
                                <div class={`absolute top-[88px] w-3 h-3 rounded-full ${colors.dot} ring-4 ring-background z-20`} />

                                <!-- Title -->
                                <h3 class="mt-8 text-lg font-bold text-foreground">{stepTranslation.title}</h3>

                                <!-- Description -->
                                <p class="mt-2 text-sm text-foreground-secondary leading-relaxed px-2">
                                    {stepTranslation.description}
                                </p>
                            </div>
                        );
                    })}
                </div>
            </div>
        </div>

        <!-- Mobile Timeline (vertical) -->
        <div class="lg:hidden mt-8">
            <div class="relative">
                <!-- Vertical line -->
                <div class="absolute left-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-violet-500 via-fuchsia-500 to-emerald-500 opacity-30" />

                <!-- Steps -->
                <div class="space-y-8">
                    {processSteps.map((step, index) => {
                        const stepTranslation = translations.steps[step.id];
                        const colors = stepColors[index];
                        const iconSvg = iconImports[step.iconId];

                        return (
                            <div class="relative flex items-start gap-6 pl-2">
                                <!-- Icon container -->
                                <div
                                    class={`relative z-10 flex-shrink-0 w-12 h-12 rounded-xl ${colors.bg} ${colors.border} border flex items-center justify-center`}
                                >
                                    <div class={`w-6 h-6 ${colors.text}`} set:html={iconSvg} />
                                </div>

                                <!-- Content -->
                                <div class="flex-1 pb-2">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class={`text-xs font-bold ${colors.text}`}>
                                            {String(step.number).padStart(2, '0')}
                                        </span>
                                        <h3 class="text-lg font-bold text-foreground">{stepTranslation.title}</h3>
                                    </div>
                                    <p class="text-sm text-foreground-secondary leading-relaxed">
                                        {stepTranslation.description}
                                    </p>
                                </div>
                            </div>
                        );
                    })}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .process-section {
        background: linear-gradient(
            180deg,
            transparent 0%,
            hsl(var(--color-primary) / 0.03) 50%,
            transparent 100%
        );
    }
</style>
