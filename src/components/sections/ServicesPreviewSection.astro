---
/**
 * ServicesPreviewSection - Homepage preview of available services
 * Shows 4 service cards with key features and links to full service pages
 * Positioned between Projects and Blog sections
 */

import AnimatedGradientBackground from '@/components/ui/AnimatedGradientBackground.astro';
import SectionTitle from '@/components/ui/SectionTitle.astro';
import ServicePreviewCard from '@/components/ui/ServicePreviewCard.astro';
import { services } from '@/data/services';
import ArrowLongRightIcon from '@/icons/ui/arrow-long-right.svg?raw';

interface ServiceTranslation {
    title: string;
    description: string;
    features: string[];
}

interface Props {
    primaryColor?: string;
    lang: string;
    translations: {
        title: string;
        subtitle: string;
        description?: string;
        viewAll: string;
        learnMore: string;
        whyWorkWithMe: {
            title: string;
            items: string[];
        };
        services: {
            webApps: ServiceTranslation;
            landingPages: ServiceTranslation;
            automation: ServiceTranslation;
            socialDesign: ServiceTranslation;
            webOptimization: ServiceTranslation;
            wordpress: ServiceTranslation;
        };
    };
}

const { primaryColor = '#8b5cf6', lang, translations } = Astro.props;

// Service ID to translation key mapping
const serviceTranslationMap: Record<string, keyof typeof translations.services> = {
    'web-apps': 'webApps',
    'landing-pages': 'landingPages',
    'automation-integration': 'automation',
    'social-media-design': 'socialDesign',
    'web-optimization': 'webOptimization',
    wordpress: 'wordpress'
};

// Map services data with translations
const serviceCards = services.map((service) => {
    const translationKey = serviceTranslationMap[service.id];
    const serviceTranslation = translations.services[translationKey];
    return {
        id: service.id,
        slug: service.slug,
        iconId: service.iconId,
        title: serviceTranslation.title,
        description: serviceTranslation.description,
        features: serviceTranslation.features
    };
});
---

<section
    class="relative section section-services-preview overflow-hidden py-20 md:py-28"
    id="services-preview"
    style={`background-color: ${primaryColor}`}
>
    <!-- Animated Gradient Background -->
    <AnimatedGradientBackground />

    <div class="container-custom relative z-10">
        <!-- Section Title -->
        <SectionTitle
            title={translations.title}
            subtitle={translations.subtitle}
            description={translations.description}
            descriptionClassName="!text-base !max-w-3xl mx-auto mt-6 leading-relaxed"
        />

        <!-- Services Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            {serviceCards.map((service) => (
                <ServicePreviewCard
                    title={service.title}
                    description={service.description}
                    features={service.features}
                    href={`/${lang}/services/${service.slug}`}
                    ctaText={translations.learnMore}
                    iconId={service.iconId}
                />
            ))}
        </div>

        <!-- Why Work With Me Section -->
        <div class="mt-16 p-8 rounded-2xl bg-background/20 backdrop-blur-sm border border-primary/20">
            <h3 class="text-2xl font-bold text-foreground mb-6 text-center">
                <span set:html={translations.whyWorkWithMe.title} />
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                {translations.whyWorkWithMe.items.map((item, index) => (
                    <div class="flex items-center gap-3 p-4 rounded-xl bg-background/30 border border-primary/10">
                        <span class="flex-shrink-0 w-8 h-8 rounded-full bg-primary/20 text-primary flex items-center justify-center font-bold text-sm">
                            {index + 1}
                        </span>
                        <span class="text-foreground-secondary text-sm">{item}</span>
                    </div>
                ))}
            </div>
        </div>

        <!-- View All Services Button -->
        <div class="text-center mt-12">
            <a
                href={`/${lang}/services`}
                class="group inline-flex items-center gap-3 px-8 py-4 bg-background/50 hover:bg-background/70 backdrop-blur-sm border-2 border-primary/30 hover:border-primary/50 rounded-lg text-foreground font-semibold text-lg transition-all duration-300 hover:scale-105 hover:shadow-xl hover:shadow-primary/20"
            >
                <span set:html={translations.viewAll} />
                <div class="w-6 h-6 text-primary transition-transform duration-300 group-hover:translate-x-1" aria-hidden="true" set:html={ArrowLongRightIcon} />
            </a>
        </div>
    </div>
</section>
