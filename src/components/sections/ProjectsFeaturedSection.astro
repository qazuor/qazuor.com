---
import { ProjectsFeaturedStack } from '@/components/sections/ProjectsFeaturedStack';
import AnimatedGradientBackground from '@/components/ui/AnimatedGradientBackground.astro';
import SectionTitle from '@/components/ui/SectionTitle.astro';

interface OptimizedImage {
    src: string;
    width: number;
    height: number;
}

interface Project {
    title: string;
    description: string;
    slug: string;
    technologies: string[];
    images: OptimizedImage[];
    featured: boolean;
    order: number;
}

interface Props {
    projects: Project[];
    primaryColor?: string;
    translations?: {
        title: string;
        subtitle: string;
        description?: string;
        viewAll: string;
    };
    lang?: string;
}

const {
    projects = [],
    primaryColor = 'var(--section-projects-bg)',
    translations = {
        title: 'Featured Projects',
        subtitle: 'Explore some of my best work and recent projects',
        viewAll: 'View All Projects'
    },
    lang = 'en'
} = Astro.props;

// Filter featured projects and sort by order
const featuredProjects = projects
    .filter((p) => p.featured)
    .sort((a, b) => a.order - b.order)
    .slice(0, 4); // Max 4 featured projects
---

<div
	id="projects"
	class="section section-blue relative"
	style={`background-color: ${primaryColor}`}
>
	<AnimatedGradientBackground />

	<!-- Header Section -->
	<div class="pb-16 md:pb-24 relative z-10">
		<div class="container-custom">
			<SectionTitle
				title={translations.title}
				subtitle={translations.subtitle}
				description={translations.description}
				descriptionClassName="!text-base !max-w-3xl mx-auto mt-6 leading-relaxed"
			/>
		</div>
	</div>

	<!-- Stacking Cards Section -->
	<div class="relative z-[200]" role="region" aria-label="Featured projects showcase">
		<ProjectsFeaturedStack
			client:visible
			projects={featuredProjects}
			lang={lang}
			viewAllUrl={featuredProjects.length > 0 ? `/${lang}/projects` : undefined}
			viewAllText={translations.viewAll}
		/>
	</div>
</div>
